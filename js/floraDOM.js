/*
FloraJS | DOM Renderer
Copyright (c) 2012 Vince Allen
Brooklyn, NY 11215, USA
email: vince@vinceallen.com
web: http://www.vinceallen.com

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
/* Version: 0.0.3 */
/* Build time: November 17, 2012 03:48:10 */
var Flora={},exports=Flora;
(function(c){function p(){this._records=[]}function v(){}function i(a,b){this.x=a||0;this.y=b||0}function t(){this._gradients=[];this._colors=[]}function y(){}function z(){this._borders=[]}function k(a){var b=this,a=a||{};this.isPlaying=a.isPlaying||!0;this.zSorted=!!a.zSorted;this.showStats=!!a.showStats;this.isDeviceMotion=!!a.isDeviceMotion;this._records=[];this._statsDisplay=null;c.Utils.addEvent(document.body,"mousemove",function(a){c.mouse.locLast=c.mouse.loc.clone();a.pageX&&a.pageY?c.mouse.loc=
new c.Vector(a.pageX,a.pageY):a.clientX&&a.clientY&&(c.mouse.loc=new c.Vector(a.clientX,a.clientY))});c.Utils.addEvent(document,"keyup",function(a){a.keyCode===c.config.keyMap.pause?b.pauseSystem():a.keyCode===c.config.keyMap.reset?b.resetSystem():a.keyCode===c.config.keyMap.stats&&b.toggleStats()});c.Utils.addEvent(document,"touchstart",function(a){a=a.touches;2===a.length?b.toggleStats():3===a.length?b.pauseSystem():4===a.length&&b.resetSystem()});c.Utils.addEvent(document.body,"keydown",function(a){var b,
e=c.elementList.all(),h,f,j,l;switch(a.keyCode){case c.config.keyMap.thrustLeft:a=0;for(b=e.length;a<b;a++)e[a].keyControl&&(h=e[a],j=h.world.width/2,l=c.Utils.degreesToRadians(h.angle-h.turningRadius),f=j*Math.cos(l),j*=Math.sin(l),f=c.Vector.VectorAdd(new c.Vector(f,j),h.location),f=c.Vector.VectorSub(f,h.location),f.normalize(),f.mult(2*h.velocity.mag()),f=c.Vector.VectorSub(f,h.velocity),h.applyForce(f));break;case c.config.keyMap.thrustUp:a=0;for(b=e.length;a<b;a++)e[a].keyControl&&(h=e[a],j=
h.world.width/2,l=c.Utils.degreesToRadians(h.angle),f=j*Math.cos(l),j*=Math.sin(l),f=new c.Vector(f,j),f.normalize(),f.mult(h.thrust),f.limit(h.maxSpeed),e[a].applyForce(f));break;case c.config.keyMap.thrustRight:a=0;for(b=e.length;a<b;a++)e[a].keyControl&&(h=e[a],j=h.world.width/2,l=c.Utils.degreesToRadians(h.angle+h.turningRadius),f=j*Math.cos(l),j*=Math.sin(l),f=c.Vector.VectorAdd(new c.Vector(f,j),h.location),f=c.Vector.VectorSub(f,h.location),f.normalize(),f.mult(2*h.velocity.mag()),f=c.Vector.VectorSub(f,
h.velocity),e[a].applyForce(f));break;case c.config.keyMap.thrustDown:a=0;for(b=e.length;a<b;a++)e[a].keyControl&&e[a].velocity.mult(0.5)}});c.System.supportedFeatures.touch&&this.isDeviceMotion&&this.addDeviceMotionEventListener();this.showStats&&this.createStats()}function q(a){var b=this,a=a||{},g=c.Utils.getWindowSize();this.isStatic=a.isStatic||!0;this.clock=a.clock||0;this.c=a.c||0.01;this.gravity=a.gravity||new c.Vector(0,1);this.wind=a.wind||new c.Vector;this.location=a.location||new c.Vector;
this.scale=a.scale||1;this.angle=a.angle||0;this.opacity=a.opacity||1;this.colorMode=a.colorMode||"rgb";this.color=a.color||[0,0,0];this.borderWidth=a.borderWidth||0;this.borderStyle=a.borderStyle||"none";this.borderColor=a.borderColor||null;this.borderRadius=a.borderRadius||0;this.boxShadow=a.boxShadow||0;this.zIndex=0;this.beforeStep=a.beforeStep||void 0;this.afterStep=a.afterStep||void 0;a.el?(this.el=a.el,this.id=this.el.id,this.width=this.el.offsetWidth,this.height=this.el.offsetHeight):(this.el=
document.body,this.width=g.width,this.height=g.height,this.id=q.name+"-"+q._idCount);this.el.className="world floraElement";this.el.style.width=this.width+"px";this.el.style.height=this.height+"px";q._idCount+=1;c.Utils.addEvent(window,"resize",function(){b.resize.call(b)})}function E(a){a=a||{};this.location=a.location||new c.Vector(0,0);this.controlObj=a.controlObj||null}function m(a){var b,g,d,e;b=0;for(g=arguments.length;b<g;b+=1)for(d in e=arguments[b],e)e.hasOwnProperty(d)&&(this[d]=e[d]);b=
a||{};g=c.elementList.all()||[];d=c.liquids||[];e=c.repellers||[];var h=c.attractors||[],f=c.heats||[],j=c.colds||[],l=c.predators||[],i=c.lights||[],F=c.oxygen||[],n=c.food||[],o,k=this.name||"anon";this.id=b.id||k.toLowerCase()+"-"+m._idCount;this.el=b.view&&"function"===c.Interface.getDataType(b.view)?b.view.apply(this,b.viewArgs):"object"===c.Interface.getDataType(b.view)?b.view:document.createElement("div");o=this.world=b.world||c.universe.first();this.location=b.location||new c.Vector(o.width/
2,o.height/2);this.acceleration=b.acceleration||new c.Vector;this.velocity=b.velocity||new c.Vector;this.width=0===b.width?0:b.width||20;this.height=0===b.height?0:b.height||20;this.scale=0===b.scale?0:b.scale||1;this.angle=b.angle||0;this.opacity=0===b.opacity?0:b.opacity||0.85;this.colorMode=b.colorMode||"rgb";this.color=b.color||null;this.zIndex=0===b.zIndex?0:b.zIndex||1;this.borderWidth=b.borderWidth||null;this.borderStyle=b.borderStyle||null;this.borderColor=b.borderColor||null;this.borderRadius=
b.borderRadius||null;this.boxShadow=b.boxShadow||null;this.sensors=b.sensors||[];this.className=b.className||k.toLowerCase();this.className+=" floraElement";g.push(this);this.el.id=this.id;this.el.className=0<this.sensors.length?this.className+" hasSensor":this.className;this.el.style.display="none";o.el&&o.el.appendChild(this.el);m._idCount+=1;-1!==this.className.search("liquid")?d.push(this):-1!==this.className.search("repeller")?e.push(this):-1!==this.className.search("attractor")?h.push(this):
-1!==this.className.search("heat")?f.push(this):-1!==this.className.search("cold")?j.push(this):-1!==this.className.search("predator")?l.push(this):-1!==this.className.search("light")?i.push(this):-1!==this.className.search("oxygen")?F.push(this):-1!==this.className.search("food")&&n.push(this);if(this.controlCamera=!!b.controlCamera)c.camera.controlObj=this,o.location.x=-o.width/2+c.Utils.getWindowSize().width/2+(o.width/2-this.location.x),o.location.y=-o.height/2+c.Utils.getWindowSize().height/
2+(o.height/2-this.location.y)}function B(a){a=a||{};this.world=a.world||c.universe.first();this.position=a.position||"top left";this.text=a.text||"";this.opacity=0===a.opacity?0:a.opacity||0.75;this.color=a.color||[255,255,255];this.borderWidth=a.borderWidth||"1px";this.borderStyle=a.borderStyle||"solid";this.borderColor=a.borderColor||[204,204,204];this.colorMode=a.colorMode||"rgb";this._el=document.createElement("div");this._el.id="caption";this._el.className="caption "+this.position;this._el.style.opacity=
this.opacity;this._el.style.color=this.colorMode+"("+this.color[0]+", "+this.color[1]+", "+this.color[2]+")";this._el.style.borderWidth=this.borderWidth;this._el.style.borderStyle=this.borderStyle;this._el.style.borderColor="string"===typeof this.borderColor?this.borderColor:this.colorMode+"("+this.borderColor[0]+", "+this.borderColor[1]+", "+this.borderColor[2]+")";this._el.appendChild(document.createTextNode(this.text));document.getElementById("caption")&&document.getElementById("caption").parentNode.removeChild(document.getElementById("caption"));
this.world.el.appendChild(this._el)}function C(a){var b=this,a=a||{};this.world=a.world||c.universe.first();this.position=a.position||"top left";this.opacity=0===a.opacity?0:a.opacity||0.75;this.color=a.color||[255,255,255];this.borderWidth=a.borderWidth||"1px";this.borderStyle=a.borderStyle||"solid";this.borderColor=a.borderColor||[204,204,204];this.colorMode=a.colorMode||"rgb";this.text=c.System.supportedFeatures.touch?c.config.touchMap.stats+"-finger tap = stats | "+c.config.touchMap.pause+"-finger tap = pause | "+
c.config.touchMap.reset+"-finger tap = reset":"'"+String.fromCharCode(c.config.keyMap.pause).toLowerCase()+"' = pause | '"+String.fromCharCode(c.config.keyMap.reset).toLowerCase()+"' = reset | '"+String.fromCharCode(c.config.keyMap.stats).toLowerCase()+"' = stats";this._el=document.createElement("div");this._el.id="inputMenu";this._el.className="inputMenu "+this.position;this._el.style.opacity=this.opacity;this._el.style.color=this.colorMode+"("+this.color[0]+", "+this.color[1]+", "+this.color[2]+
")";this._el.style.borderWidth=this.borderWidth;this._el.style.borderStyle=this.borderStyle;this._el.style.borderColor="string"===typeof this.borderColor?this.borderColor:this.colorMode+"("+this.borderColor[0]+", "+this.borderColor[1]+", "+this.borderColor[2]+")";this._el.appendChild(document.createTextNode(this.text));document.getElementById("inputMenu")&&document.getElementById("inputMenu").parentNode.removeChild(document.getElementById("inputMenu"));c.System.supportedFeatures.touch?c.Utils.addEvent(this._el,
"touchstart",function(){b.destroy()}):c.Utils.addEvent(this._el,"mouseup",function(){b.destroy()});this.world.el.appendChild(this._el)}function A(){var a,b;this._fps=0;this._timeLastSecond=this._timeLastFrame=this._time=Date.now?Date.now():0;this._frameCount=0;this._el=document.createElement("div");this._el.id="statsDisplay";this._el.className="statsDisplay";this._el.style.color="white";this._fpsValue=this._totalElementsValue=null;a=document.createElement("span");a.className="statsDisplayLabel";b=
document.createTextNode("trans3d: ");a.appendChild(b);this._el.appendChild(a);this._3dTransformsValue=document.createTextNode(c.System.supportedFeatures.csstransforms3d);this._el.appendChild(this._3dTransformsValue);a=document.createElement("span");a.className="statsDisplayLabel";b=document.createTextNode("total elements: ");a.appendChild(b);this._el.appendChild(a);this._totalElementsValue=document.createTextNode("0");this._el.appendChild(this._totalElementsValue);a=document.createElement("span");
a.className="statsDisplayLabel";b=document.createTextNode("fps: ");a.appendChild(b);this._el.appendChild(a);this._fpsValue=document.createTextNode("0");this._el.appendChild(this._fpsValue);document.body.appendChild(this._el);this._update(this)}function w(){}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};c.config={borderStyles:"none solid dotted dashed double inset outset groove ridge".split(" "),
defaultColorList:[{name:"heat",startColor:[255,132,86],endColor:[175,47,0]},{name:"cold",startColor:[88,129,135],endColor:[171,244,255]},{name:"food",startColor:[186,255,130],endColor:[84,187,0]},{name:"oxygen",startColor:[109,215,255],endColor:[0,140,192]},{name:"light",startColor:[255,227,127],endColor:[189,148,0]}],keyMap:{pause:80,reset:82,stats:83,thrustLeft:37,thrustUp:38,thrustRight:39,thrustDown:40},touchMap:{stats:2,pause:3,reset:4}};p.prototype.name="ElementList";p.prototype.add=function(a){this._records.push(a);
return this._records};p.prototype.all=function(){return this._records};p.prototype.count=function(){return this._records.length};p.prototype.getAllByName=function(a){var b,c,d=[];b=0;for(c=this._records.length;b<c;b++)this._records[b].name===a&&(d[d.length]=this._records[b]);return d};p.prototype.updatePropsByName=function(a,b){var c,d,e,h=this.getAllByName(a);c=0;for(d=h.length;c<d;c++)for(e in b)b.hasOwnProperty(e)&&(h[c][e]=b[e]);return h};p.prototype.getElement=function(a){var b,c,d=this._records;
b=0;for(c=d.length;b<c;b+=1)if(d[b].id===a)return d[b]};p.prototype.destroyElement=function(a){var b,c,d=this._records;b=0;for(c=d.length;b<c;b+=1)if(d[b].id===a){d[b].world.el.removeChild(d[b].el);d.splice(b,1);break}};p.prototype.destroyAll=function(){var a,b=this._records;for(a=b.length-1;0<=a;a-=1)b[a].world&&b[a].world.el.removeChild(b[a].el);this._records=[]};p.prototype.destroyByWorld=function(a){var b,c=this._records;for(b=c.length-1;0<=b;b-=1)c[b].world&&c[b].world===a&&(c[b].world.el.removeChild(c[b].el),
c.splice(b,1))};c.ElementList=p;v.name="System";v.setup=null;v.start=function(a,b,g){var d=c.config.defaultColorList;this.universeOptions=b||null;this.worlds=g||null;this._featureDetector=new c.FeatureDetector;this.supportedFeatures={};this.supportedFeatures.csstransforms=this._featureDetector.detect("csstransforms");this.supportedFeatures.csstransforms3d=this._featureDetector.detect("csstransforms3d");this.supportedFeatures.touch=this._featureDetector.detect("touch");c.liquids=[];c.repellers=[];
c.attractors=[];c.heats=[];c.colds=[];c.lights=[];c.oxygen=[];c.food=[];c.predators=[];c.mouse={loc:new c.Vector,locLast:new c.Vector};c.elementList=new c.ElementList;c.universe=new c.Universe(this.universeOptions);if("array"===c.Interface.getDataType(this.worlds)){b=0;for(g=this.worlds.length;b<g;b+=1)c.universe.addWorld({el:this.worlds[b]})}else c.universe.addWorld();c.camera=new c.Camera;c.defaultColors=new c.ColorTable;b=0;for(g=d.length;b<g;b++)c.defaultColors.addColor({name:d[b].name,startColor:d[b].startColor,
endColor:d[b].endColor});c.animLoop=function(){var a;a=c.universe;var b=c.elementList.all();if(a.isPlaying){window.requestAnimFrame(c.animLoop);a.zSorted&&(b=b.sort(function(a,b){return b.zIndex-a.zIndex}));for(a=b.length-1;0<=a;a-=1)b[a].step(),b[a]&&b[a].draw();c.universe.updateClocks()}};a="function"===c.Interface.getDataType(a)?a:function(){};v.setup=a;a();c.animLoop()};v.destroy=function(){c.elementList.destroyAll()};c.System=v;c.Utils={extend:function(a,b){function c(){}c.prototype=b.prototype;
a.prototype=new c;a.prototype.constructor=a},map:function(a,b,c,d,e){return(a-b)/(c-b)*(e-d)+d},getRandomNumber:function(a,b,c){return c?Math.random()*(b-(a-1))+a:Math.floor(Math.random()*(b-(a-1)))+a},degreesToRadians:function(a){if("undefined"!==typeof a)return 2*Math.PI*(a/360);"undefined"!==typeof console&&console.log("Error: Utils.degreesToRadians is missing degrees param.");return!1},radiansToDegrees:function(a){if("undefined"!==typeof a)return a*(180/Math.PI);"undefined"!==typeof console&&
console.log("Error: Utils.radiansToDegrees is missing radians param.");return!1},constrain:function(a,b,c){return a>c?c:a<b?b:a},clone:function(a){function b(){}b.prototype=a;return new b},addEvent:function(a,b,c){a.addEventListener?this.addEventHandler=function(a,b,c){a.addEventListener(b,c,!1)}:a.attachEvent&&(this.addEventHandler=function(a,b,c){a.attachEvent("on"+b,c)});this.addEventHandler(a,b,c)},log:function(a){"undefined"!==typeof console&&"undefined"!==typeof console.log?(this.log=function(a){console.log(a)},
this.log.call(this,a)):this.log=function(){}},getWindowSize:function(){var a={width:!1,height:!1};"undefined"!==typeof window.innerWidth?a.width=window.innerWidth:"undefined"!==typeof document.documentElement&&"undefined"!==typeof document.documentElement.clientWidth?a.width=document.documentElement.clientWidth:"undefined"!==typeof document.body&&(a.width=document.body.clientWidth);"undefined"!==typeof window.innerHeight?a.height=window.innerHeight:"undefined"!==typeof document.documentElement&&"undefined"!==
typeof document.documentElement.clientHeight?a.height=document.documentElement.clientHeight:"undefined"!==typeof document.body&&(a.height=document.body.clientHeight);return a},getCSSText:function(a){var b="";a.color?a.background=a.cm+"("+a.color[0]+", "+a.color[1]+", "+a.color[2]+")":(a.color=[],a.background=null);a.borderColor?a.borderColorStr=a.cm+"("+a.borderColor[0]+", "+a.borderColor[1]+", "+a.borderColor[2]+")":(a.borderColor=[],a.borderColorStr="");b=c.System.supportedFeatures.csstransforms3d?
["-webkit-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-moz-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-o-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-ms-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")"].join(";"):c.System.supportedFeatures.csstransforms?["-webkit-transform: translateX("+
a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-moz-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-o-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-ms-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")"].join(";"):["position: absolute","left: "+a.x+"px","top: "+a.y+"px"].join(";");return[b,
"opacity: "+a.o,"width: "+a.w+"px","height: "+a.h+"px","background: "+a.background,"z-index: "+a.z,"border-width: "+a.borderWidth+"px","border-style: "+a.borderStyle,"border-color: "+a.borderColorStr,"border-radius: "+a.borderRadius,"box-shadow: "+a.boxShadow].join(";")}};i.VectorSub=function(a,b){return new i(a.x-b.x,a.y-b.y)};i.VectorAdd=function(a,b){return new i(a.x+b.x,a.y+b.y)};i.VectorMult=function(a,b){return new i(a.x*b,a.y*b)};i.VectorDiv=function(a,b){return new i(a.x/b,a.y/b)};i.VectorDistance=
function(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))};i.VectorMidPoint=function(a,b){return i.VectorAdd(a,b).div(2)};i.VectorAngleBetween=function(a,b){var c=a.dot(b);return Math.acos(c/(a.mag()*b.mag()))};i.prototype.name="Vector";i.prototype.clone=function(){function a(){}a.prototype=this;return new a};i.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};i.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};i.prototype.mult=function(a){this.x*=a;this.y*=
a;return this};i.prototype.div=function(a){this.x/=a;this.y/=a;return this};i.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};i.prototype.limit=function(a){this.mag()>a&&(this.normalize(),this.mult(a));return this};i.prototype.limitLow=function(a){this.mag()<a&&(this.normalize(),this.mult(a));return this};i.prototype.normalize=function(){var a=this.mag();if(0!==a)return this.div(a)};i.prototype.distance=function(a){return Math.sqrt(Math.pow(a.x-this.x,2)+Math.pow(a.y-this.y,
2))};i.prototype.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.x,d=this.y;this.x=c*b-d*a;this.y=c*a+d*b;return this};i.prototype.midpoint=function(a){return i.VectorAdd(this,a).div(2)};i.prototype.dot=function(a){return this.z&&a.z?this.x*a.x+this.y*a.y+this.z*a.z:this.x*a.x+this.y*a.y};c.Vector=i;t.prototype.name="ColorPalette";t.prototype.addColor=function(a){var b,g;if(c.Interface.checkRequiredParams(a,{min:"number",max:"number",startColor:"array",endColor:"array"})){b=c.Utils.getRandomNumber(a.min,
a.max);g=t._createColorRange(a.startColor,a.endColor,255);for(a=0;a<b;a++)this._colors.push(g[c.Utils.getRandomNumber(0,g.length-1)])}return this};t.prototype.createGradient=function(a){if(c.Interface.checkRequiredParams(a,{startColor:"array",endColor:"array"}))if(this.startColor=a.startColor,this.endColor=a.endColor,this.totalColors=a.totalColors||255,0<this.totalColors)this._gradients.push(t._createColorRange(this.startColor,this.endColor,this.totalColors));else throw Error("ColorPalette: total colors must be greater than zero.");
};t.prototype.getColor=function(){if(0<this._colors.length)return this._colors[c.Utils.getRandomNumber(0,this._colors.length-1)];throw Error("ColorPalette.getColor: You must add colors via addColor() before using getColor().");};t.prototype.createSampleStrip=function(a){var b,c,d;b=0;for(c=this._colors.length;b<c;b++)d=document.createElement("div"),d.className="color-sample-strip",d.style.background="rgb("+this._colors[b].toString()+")",a.appendChild(d)};t._createColorRange=function(a,b,c){var d,
e=[],h=a[0],f=a[1],a=a[2],j=b[1];d=b[2];var l,i,k,n,b=b[0]-h,j=j-f;l=d-a;for(d=0;d<c;d++)i=parseInt(b*d/c,10)+h,k=parseInt(j*d/c,10)+f,n=parseInt(l*d/c,10)+a,e.push([i,k,n]);return e};c.ColorPalette=t;y.prototype.addColor=function(a){c.Interface.checkRequiredParams(a,{name:"string",startColor:"array",endColor:"array"})&&(this[a.name]={startColor:a.startColor,endColor:a.endColor});return this};y.prototype.name="ColorTable";y.prototype.getColor=function(a,b,g){var d,e;if("string"===c.Interface.getDataType(a))if(this[a]){a=
this[a];b&&(d=a.startColor);g&&(e=a.endColor);if(d&&e||!d&&!e)return{startColor:a.startColor,endColor:a.endColor};if(d)return d;if(e)return e}else throw Error("ColorTable: "+a+" does not exist. Add colors to the ColorTable via addColor().");else throw Error("ColorTable: You must pass a name (string) for the color entry in the table.");};c.ColorTable=y;z.prototype.name="BorderPalette";z.prototype.addBorder=function(a){var b,g;if(c.Interface.checkRequiredParams(a,{min:"number",max:"number",style:"string"})){g=
c.Utils.getRandomNumber(a.min,a.max);for(b=0;b<g;b++)this._borders.push(a.style)}return this};z.prototype.getBorder=function(){if(0<this._borders.length)return this._borders[c.Utils.getRandomNumber(0,this._borders.length-1)];throw Error("BorderPalette.getBorder: You must add borders via addBorder() before using getBorder().");};c.BorderPalette=z;var u={random:function(){return 0.1}};void 0===u&&(u=Math);var r,D=[];for(r=0;256>r;r+=1)D[r]=Math.floor(256*u.random());u=[];for(r=0;512>r;r+=1)u[r]=D[r&
255];c.SimplexNoise={grad3:[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],p:D,perm:u,simplex:[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,
0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]],dot:function(a,b,c){return a[0]*b+a[1]*c},noise:function(a,b){var c,d,e;e=0.5*(Math.sqrt(3)-1);e*=a+b;var h=Math.floor(a+e),f=Math.floor(b+e),j=(3-Math.sqrt(3))/6;e=(h+f)*j;c=a-(h-e);var l=b-(f-e),i,k;c>l?
(i=1,k=0):(i=0,k=1);d=c-i+j;var n=l-k+j;e=c-1+2*j;var j=l-1+2*j,o=h&255,f=f&255,h=this.perm[o+this.perm[f]]%12;i=this.perm[o+i+this.perm[f+k]]%12;k=this.perm[o+1+this.perm[f+1]]%12;f=0.5-c*c-l*l;0>f?c=0:(f*=f,c=f*f*this.dot(this.grad3[h],c,l));l=0.5-d*d-n*n;0>l?d=0:(l*=l,d=l*l*this.dot(this.grad3[i],d,n));n=0.5-e*e-j*j;0>n?e=0:(n*=n,e=n*n*this.dot(this.grad3[k],e,j));return 70*(c+d+e)},noise3d:function(a,b,c){var d,e,h,f=(a+b+c)*(1/3),j=Math.floor(a+f),i=Math.floor(b+f),k=Math.floor(c+f),f=1/6;h=
(j+i+k)*f;d=a-(j-h);e=b-(i-h);var m=c-(k-h),n,o,q,p,s,r;d>=e?e>=m?(n=1,q=o=0,s=p=1,r=0):(d>=m?(n=1,q=o=0):(o=n=0,q=1),p=1,s=0,r=1):e<m?(o=n=0,q=1,p=0,r=s=1):d<m?(n=0,o=1,p=q=0,r=s=1):(n=0,o=1,q=0,s=p=1,r=0);var x=d-n+f,t=e-o+f,v=m-q+f;h=d-p+2*f;var a=e-s+2*f,w=m-r+2*f,c=d-1+3*f,b=e-1+3*f,f=m-1+3*f,j=j&255,u=i&255,y=k&255,i=this.perm[j+this.perm[u+this.perm[y]]]%12,k=this.perm[j+n+this.perm[u+o+this.perm[y+q]]]%12;p=this.perm[j+p+this.perm[u+s+this.perm[y+r]]]%12;j=this.perm[j+1+this.perm[u+1+this.perm[y+
1]]]%12;s=0.6-d*d-e*e-m*m;0>s?d=0:(s*=s,d=s*s*this.dot(this.grad3[i],d,e,m));e=0.6-x*x-t*t-v*v;0>e?e=0:(e*=e,e=e*e*this.dot(this.grad3[k],x,t,v));x=0.6-h*h-a*a-w*w;0>x?h=0:(x*=x,h=x*x*this.dot(this.grad3[p],h,a,w));a=0.6-c*c-b*b-f*f;0>a?c=0:(a*=a,c=a*a*this.dot(this.grad3[j],c,b,f));return 32*(d+e+h+c)}};c.Interface={checkRequiredParams:function(a,b,c){var d,e,h=!0;for(d in b)if(b.hasOwnProperty(d))try{if("undefined"===typeof a)throw Error("checkRequiredOptions: No options were passed.");if(!this.checkDataType(this.getDataType(a[d]),
b[d].split("|"))||""===a[d])throw h=!1,e=""===a[d]?'checkRequiredOptions: required option "'+d+'" is empty.':"undefined"===typeof a[d]?'checkRequiredOptions: required option "'+d+'" is missing from passed options.':'checkRequiredOptions: passed option "'+d+'" must be type '+b[d]+". Passed as "+this.getDataType(a[d])+".",Error(e);}catch(f){"undefined"!==typeof console&&console.log("ERROR: "+f.message+(c?" from: "+c:""))}return h},checkDataType:function(a,b){var c,d;c=0;for(d=b.length;c<d;c++)if(a===
b[c])return!0;return!1},getDataType:function(a){return"[object Array]"===Object.prototype.toString.call(a)?"array":"[object NodeList]"===Object.prototype.toString.call(a)?"nodeList":typeof a}};k.prototype.name="Universe";k.prototype.addWorld=function(a){this._records.push(new c.World(a||{}));c.elementList.add(this._records[this._records.length-1]);return this._records};k.prototype.first=function(){return this._records[0]?this._records[0]:null};k.prototype.last=function(){return this._records[this._records.length-
1]?this._records[this._records.length-1]:null};k.prototype.update=function(a,b){var g,d="object"===c.Interface.getDataType(a)?a:{},e;if(b)if("string"===c.Interface.getDataType(b))e=this.getWorldById(b);else if("object"===c.Interface.getDataType(b))e=b;else{c.Utils.log("Universe: update: world param must be null, a string (an id) or reference to a world.");return}else e=this.first();for(g in d)d.hasOwnProperty(g)&&(e[g]=d[g]);d.el&&(e.width=parseInt(e.el.style.width.replace("px",""),10),e.height=parseInt(e.el.style.height.replace("px",
""),10));c.System.supportedFeatures.touch&&d.isDeviceMotion&&this.addDeviceMotionEventListener()};k.prototype.all=function(){return this._records};k.prototype.count=function(){return this._records.length};k.prototype.getWorldById=function(a){var b,c,d=this._records;b=0;for(c=d.length;b<c;b+=1)if(d[b].id===a)return d[b];return null};k.prototype.destroyWorld=function(a){var b,g,d=this._records;b=0;for(g=d.length;b<g;b+=1)if(d[b].id===a){a=d[b].el.parentNode;d[b].el===document.body?c.elementList.destroyAll():
(c.elementList.destroyByWorld(d[b]),a.removeChild(d[b].el));d.splice(b,1);break}};k.prototype.clearWorld=function(a){var b,g,d=this._records;b=0;for(g=d.length;b<g;b+=1)if(d[b].id===a)return c.elementList.destroyByWorld(d[b]),!0};k.prototype.destroyAll=function(){c.elementList.destroyAll();for(var a=this._records.length-1;0<=a;a-=1)this.destroyWorld(this._records[a].id)};k.prototype.updateClocks=function(){for(var a=0,b=this._records.length;a<b;a+=1)this._records[a].clock+=1};k.prototype.pauseSystem=
function(){(this.isPlaying=!this.isPlaying)&&window.requestAnimFrame(c.animLoop);return this.isPlaying};k.prototype.resetSystem=function(){var a,b,g;g=this.all();a=0;for(b=g.length;a<b;a+=1)c.elementList.destroyByWorld(g[a]);c.System.setup();this.isPlaying||(this.isPlaying=!0,window.requestAnimFrame(c.animLoop))};k.prototype.toggleStats=function(){this._statsDisplay?this.destroyStats():this.createStats();return this._statsDisplay};k.prototype.createStats=function(){this._statsDisplay=new c.StatsDisplay};
k.prototype.destroyStats=function(){var a=document.getElementById("statsDisplay");this._statsDisplay=null;a&&a.parentNode.removeChild(a)};k.prototype.addDeviceMotionEventListener=function(){var a=this;c.Utils.addEvent(window,"devicemotion",function(b){a.devicemotion.call(a,b)})};k.prototype.devicemotion=function(a){0===window.orientation?this.update({gravity:new c.Vector(a.accelerationIncludingGravity.x,-1*a.accelerationIncludingGravity.y)}):-90===window.orientation?this.update({gravity:new c.Vector(a.accelerationIncludingGravity.y,
a.accelerationIncludingGravity.x)}):this.update({gravity:new c.Vector(-1*a.accelerationIncludingGravity.y,-1*a.accelerationIncludingGravity.x)})};c.Universe=k;q.prototype.name="World";q._idCount=0;q.prototype.configure=function(a){this.el=a||null||document.body;this.el.style.width=this.width+"px";this.el.style.height=this.height+"px"};q.prototype.update=function(a){var b,g,d="",a="object"===c.Interface.getDataType(a)?a:{};for(g in a)a.hasOwnProperty(g)&&(this[g]=a[g]);a.el&&(this.width=parseInt(this.el.style.width.replace("px",
""),10),this.height=parseInt(this.el.style.height.replace("px",""),10));if(this.el.style.setAttribute){if(a.style)for(b in a.style)a.style.hasOwnProperty(b)&&(d=d+b+": "+a.style[b]+";");this.el.style.setAttribute("cssText",d,0)}else if(a.style)for(b in a.style)a.style.hasOwnProperty(b)&&(this.el.style[b]=a.style[b],d=d+b+": "+a.style[b]+";")};q.prototype.resize=function(){var a,b,g;a=c.Utils.getWindowSize();var d=a.width,e=a.height,h=c.elementList.all();a=0;for(b=h.length;a<b;a+=1)if(h[a].controlCamera){g=
!0;break}if(!g){a=0;for(b=h.length;a<b;a+=1)g=h[a].location,g.x=d*(g.x/this.width),g.y=e*(g.y/this.height);this.el===document.body&&(this.width=d,this.height=e,this.el.style.width=this.width+"px",this.el.style.height=this.height+"px")}};q.prototype.step=function(){this.beforeStep&&this.beforeStep.apply(this);this.afterStep&&this.afterStep.apply(this)};q.prototype.draw=function(){if(c.camera.controlObj||!(this.isStatic&&0<this.clock))this.el.style.cssText=c.Utils.getCSSText({x:this.location.x,y:this.location.y,
s:this.scale,a:this.angle,o:this.opacity,w:this.width,h:this.height,cm:this.colorMode,color:this.color,z:this.zIndex,borderWidth:this.borderWidth,borderStyle:this.borderStyle,borderColor:this.borderColor,borderRadius:this.borderRadius,boxShadow:this.boxShadow})};c.World=q;E.prototype.name="Camera";c.Camera=E;m._idCount=0;m.events=["mouseenter","mousedown","mousemove","mouseup","mouseleave"];m.prototype.name="Element";m.mouseover=function(a,b){b.isMouseOut=!1;clearInterval(b.mouseOutInterval)};m.mousedown=
function(a,b){var c=a.target;b.isPressed=!0;b.isMouseOut=!1;b.offsetX=a.pageX-c.offsetLeft;b.offsetY=a.pageY-c.offsetTop};m.mousemove=function(a,b){var g,d;b.isPressed&&(b.isMouseOut=!1,g=a.pageX-b.world.el.offsetLeft,d=a.pageY-b.world.el.offsetTop,m.mouseIsInsideWorld(b.world)?b.location=new c.Vector(g,d):b.isPressed=!1)};m.mouseup=function(a,b){b.isPressed=!1};m.mouseout=function(a,b){var g,d;b.isPressed&&(b.isMouseOut=!0,b.mouseOutInterval=setInterval(function(){b.isPressed&&b.isMouseOut&&(g=c.mouse.loc.x-
b.world.el.offsetLeft,d=c.mouse.loc.y-b.world.el.offsetTop,b.location=new c.Vector(g,d))},16))};m.mouseIsInsideWorld=function(a){var b=c.mouse.loc.x,g=c.mouse.loc.y;return a&&b>a.location.x&&b<a.location.x+a.width&&g>a.location.y&&g<a.location.y+a.height?!0:!1};m.prototype.step=function(){};m.prototype.draw=function(){this.el.style.cssText=c.Utils.getCSSText({x:this.location.x-this.width/2,y:this.location.y-this.height/2,s:this.scale,a:this.angle,o:this.opacity,w:this.width,h:this.height,cm:this.colorMode,
color:this.color,z:this.zIndex,borderWidth:this.borderWidth,borderStyle:this.borderStyle,borderColor:this.borderColor,borderRadius:this.borderRadius,boxShadow:this.boxShadow})};c.Element=m;B.prototype.name="Caption";B.prototype.destroy=function(){this._el.parentNode.removeChild(this._el)};c.Caption=B;C.prototype.name="InputMenu";C.prototype.destroy=function(){this._el.parentNode.removeChild(this._el)};c.InputMenu=C;A.prototype.getFPS=function(){return this._fps};A.prototype._update=function(a){var b=
c.elementList.count();a._time=Date.now?Date.now():0;a._frameCount++;a._time>a._timeLastSecond+1E3&&(a._fps=a._frameCount,a._timeLastSecond=a._time,a._frameCount=0,a._fpsValue.nodeValue=a._fps,a._totalElementsValue.nodeValue=b,a._3dTransformsValue.nodeValue=c.System.supportedFeatures.csstransforms3d);var g=this;window.requestAnimFrame(function(){g._update(g)})};A.prototype.name="StatsDisplay";c.StatsDisplay=A;w.prototype.name="FeatureDetector";w.prototype.detect=function(a){return!this[a]?!1:this[a].call(this)};
w.prototype.csstransforms=function(){var a=document.createDocumentFragment(),b=document.createElement("div");a.appendChild(b);b.style.cssText="-webkit-transform: translateX(1px) translateY(1px);-moz-transform: translateX(1px) translateY(1px);-o-transform: translateX(1px) translateY(1px);-ms-transform: translateX(1px) translateY(1px)";for(var a=[b.style.transform,b.style.webkitTransform,b.style.MozTransform,b.style.OTransform,b.style.msTransform],b=!1,c=0;c<a.length;c+=1)if(a[c]){b=!0;break}return b};
w.prototype.csstransforms3d=function(){var a=document.createDocumentFragment(),b=document.createElement("div");a.appendChild(b);b.style.cssText="-webkit-transform: translate3d(1px, 1px, 0);-moz-transform: translate3d(1px, 1px, 0);-o-transform: translate3d(1px, 1px, 0);-ms-transform: translate3d(1px, 1px, 0)";for(var a=[b.style.transform,b.style.webkitTransform,b.style.MozTransform,b.style.OTransform,b.style.msTransform],b=!1,c=0;c<a.length;c+=1)if(a[c]){b=!0;break}return b};w.prototype.touch=function(){var a=
document.createElement("div");a.setAttribute("ongesturestart","return;");return"function"===typeof a.ongesturestart?!0:!1};c.FeatureDetector=w})(exports);

